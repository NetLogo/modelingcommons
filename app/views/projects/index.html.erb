<% @title = 'Projects' %>

<p><%= link_to "Create a new project", :controller => :projects, :action => :new -%></p>
<% if @projects.empty? %>
<p><i>No projects have been created.</i></p>
<% else %>
<div id="custom_filters">
Sort by<select id="project_sort_by">
	<option value="pn">Project Name</option>
	<option value="on">Owner Name</option>
	<option value="mc">Model Count</option>
</select>
<label for="project_show_you">Show only your projects<input type="checkbox" id="project_show_you" /></label>
</div>
<table id="projects_table">
	<tbody>
		<% @projects.each do |project| %>
		<tr>
			<td class="shadowbox">
				<div class="project">
					<div class="heading"><%= link_to project.name, :controller => :projects, :action => :show, :id => project.id -%></div>
					<div class="content">
					<div class="project_image">
						<a href="<%= url_for(:controller => :projects, :action => :show, :id => project.id) -%>"><img src="<%= url_for(:controller => 'projects', :action => 'image', :id => project.id) -%>" /></a>
					</div>
					<div class="project_model_list">
						<ul>
						<% num_projects_to_show = 5%>
						<% project.nodes[0..(num_projects_to_show - 1)].each do |model| %>
						<li><%= link_to truncate(model.name, :length => 23, :omission => '...'), :controller => :browse, :action => :one_model, :id => model.id -%></li>
						<% end %>
						</ul>
						<% if project.nodes.length > num_projects_to_show %>
						<p><%= link_to 'And ' << (project.nodes.length - num_projects_to_show).to_s() << ' more', :controller => :projects, :action => :show, :id => project.id -%></p>
						<% end %>
					</div>
					<h2><%= link_to person_image(project.person), :controller => :account, :action => :mypage, :id => project.person.id -%><%= person_link(project.person) -%></h2>
					</div>
				</div>
			</td>
			<td><%= project.name -%></td>
			<td><%= project.person.fullname -%></td>
			<td><%= project.nodes.count -%></td>
			<td>
				<% if project.person == @person %>
				true
				<% else %>
				false
				<% end %>
			</td>
		</tr>
		<% end %>	
	</tbody>
</table>
<% end %>
<p><%= link_to "Create a new project", :controller => :projects, :action => :new -%></p>
