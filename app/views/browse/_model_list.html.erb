<% @render_time = Hash.new(0) %>

<table class="datatable" border="1">

  <thead>
    <tr>
      <th>Preview</th>
      <th>Model</th>
      <th>Owners</th>
      <th>Tags</th>
      <th>Group</th>
      <th>Modified</th>
    </tr>
  </thead>
  <tbody>

    <% model_list.each do |model| %>

    <tr class="<%= cycle('even', 'odd') -%>">
      <td>
        <% start_time = Time.now -%>
        <img src="/browse/display_preview/<%= model.id %>" width="30" height="30" alt="Preview of model '<%= model.name -%>'" />
        <% @render_time[:preview] += Time.now - start_time -%>
        <!-- Preview render time = <%= Time.now - start_time  -%> -->
      </td>
      <td>
        <% start_time = Time.now -%>
        <!-- <%= model.name -%> -->
        <%= link_to model.name, :controller => "browse", :action => "one_model", :id => model.id %>
        <% @render_time[:name] += Time.now - start_time -%>
        <!-- Name render time = <%= Time.now - start_time  -%> -->
      </td>

      <td>
        <% start_time = Time.now -%>
        <% if model.people.empty? %>
        (No owners)
        <% else %>
        <%= model.people.map {|p| person_link(p) }.to_sentence -%>
        <% end %>

        <% @render_time[:tags] += Time.now - start_time -%>
        <!-- Authors render time = <%= Time.now - start_time  -%> -->
      </td>

      <td>
        <% start_time = Time.now -%>
        <% if model.tags.empty? %>
        (No tags)
        <% else %>
        <%= model.tags.sort_by {|t| t.name}.map {|t| link_to t.name, :controller => :tags, :action => :one_tag, :id => t.id}.uniq.join(', ') %>
        <% end %>
        <% @render_time[:tags] += Time.now - start_time -%>
        <!-- Tags render time = <%= Time.now - start_time  -%> -->
      </td>

      <td>
        <% start_time = Time.now -%>
        <% if model.group %>
        <%= group_link(model.group) %>
        <% else %>
        (No group)
        <% end %>
        <% @render_time[:group] += Time.now - start_time -%>
        <!-- Group render time = <%= Time.now - start_time  -%> -->
      </td>
      <td>
        <% start_time = Time.now -%>
        <!--<%= Time.now-model.updated_at %>-->
        <%= distance_of_time_in_words(Time.now, model.updated_at) %> ago
        <% @render_time[:last_modified] += Time.now - start_time -%>
        <!-- Last modified render time = <%= Time.now - start_time  -%> -->
      </td>
    </tr>

    <% end %>

  </tbody>
</table>

<div>
<!-- Total render time: <%= @render_time.inspect -%> -->
</div>
