<% if @model.tagged_nodes.empty? -%>
<p><i>No tags</i></p>
<% else -%>
<p>Existing tags:</p>
<ul>
  <% @model.tagged_nodes.sort_by {|t| t.updated_at}.each do |tm| -%>
  <li><%= link_to tm.tag.name, :controller => "tags", :action => "one_tag", :id => tm.tag_id -%> (<%= tm.comment -%>), by <%= person_link(tm.person) -%> <%= distance_of_time_in_words(Time.now, tm.updated_at) -%> ago </li>
  <% end -%>
</ul>
<% end -%>

<div id="add-tags">
  <h2>Add one or more tags:</h2>
  <% form_tag :controller => "tags", :action => :new do |form| -%>
  <%= hidden_field_tag :node_id, @model.id -%>
  <div id="tags">
    <%= render :partial => "add_tag", :locals => {:form => form} -%>
  </div>
  <p><%= add_tag_link "Additional tag fields" -%></p>
  <p><%= submit_tag "Submit tags" -%></p>
  <% end -%>
</div>
