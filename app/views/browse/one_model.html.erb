<% @title = @model.name %>

<p><%= link_to image_tag("download.png", :height => 40, :width => 40, :border=>0, :alt => "Download the '#{@model.name}' model"), :controller => :browse, :action => :download_model, :id => @model.id   %> <%= link_to "Download this model", :controller => "browse", :action => "download_model", :id => @model.id -%> &bull;

By:
  <%= @model.people.map {|person| person_link(person)}.join(", ") -%>
  &bull;
  <%= model_visibility(@model) %>
  &bull;
  <%= model_changeability(@model) %>

  <% if @model.author?(@person) -%>
  &bull;
  <%= link_to "Rename this model", :controller => :browse, :action => :rename_model, :id => @model.id %>
  <% end %>
<p>

  <div id="preview-image-div">
    <%= render :partial => "preview_image", :locals => {:model => @model} -%>
  </div>

  <% if !@model.projects.empty? %>
  Part of project '<%= link_to @model.projects.first.name, :controller => :projects, :action => :show, :id => @model.projects.first.id -%>'
  <% end %>

</p>

<p>
  <span id="model-atom-feed"><%= link_to image_tag("feed.png", :id => 'atom-image', :alt => "Follow '#{@model.name}' in your reader"), :controller => :browse, :action => :follow, :id => @model.id, :format => :atom -%></span>
  <!-- AddThis Button BEGIN -->
  <a class="addthis_button" href="http://addthis.com/bookmark.php?v=250&amp;username=reuvenmlerner"><img src="http://s7.addthis.com/static/btn/v2/lg-share-en.gif" width="125" height="16" alt="Bookmark and Share" style="border:0"/></a><script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#username=reuvenmlerner"></script>
  <!-- AddThis Button END -->

  <% if @person %>
  <% if @model.recommendations.select {|r| r.person_id == @person.id}.empty? %>
  <%= link_to "Recommend", :controller => :recommend, :action => :add_recommendation, :id => @model.id %>
  <% end %>

  <% if !@model.recommendations.empty? %>
  (<%= link_to pluralize(@model.recommendations.length, "recommendation"), :controller => :recommend, :action => :show_recommendations, :id => @model.id -%> to date)
  <% end %>

  &bull;

  <% if !@model.spam_warnings.empty? %>
  <%= pluralize(@model.spam_warnings.length, "person") %> marked it as spam
  <% end %>

  <% if !@person.spam_warning(@model) %>
  <%= link_to "Report as spam", :controller => :possible_spam, :action => :mark_as_spam, :id => @model.id %>
  <% end %>
  <% end %>
</p>

<div id="model-tabs">
  <ul>
    <li><a href="<%= url_for :controller => :browse, :action => :browse_preview_tab, :id => @model.id, :tab => 'true' -%>" title="preview"><span>Preview</span></a></li>
    <li><a href="<%= url_for :controller => :browse, :action => :browse_applet_tab, :id => @model.id , :tab => 'true' -%>" title="run"><span>Run</span></a></li>
    <li><a href="<%= url_for :controller => :browse, :action => :browse_info_tab, :id => @model.id , :tab => 'true' -%>" title="info"><span>Info</span></a></li>
    <li><a href="<%= url_for :controller => :browse, :action => :browse_procedures_tab, :id => @model.id , :tab => 'true' -%>" title="procedures"><span>Procedures</span></a></li>
    <li><a href="<%= url_for :controller => :browse, :action => :browse_discuss_tab, :id => @model.id , :tab => 'true' -%>" title="discuss"><span>Discuss</span></a></li>
    <li><a href="<%= url_for :controller => :browse, :action => :browse_history_tab, :id => @model.id , :tab => 'true' -%>" title="history"><span>History</span></a></li>
    <li><a href="<%= url_for :controller => :browse, :action => :browse_tags_tab, :id => @model.id , :tab => 'true' -%>" title="tags"><span>Tags</span></a></li>
    <li><a href="<%= url_for :controller => :browse, :action => :browse_files_tab, :id => @model.id , :tab => 'true' -%>" title="files"><span>Files</span></a></li>
    <li><a href="<%= url_for :controller => :browse, :action => :browse_related_tab, :id => @model.id , :tab => 'true' -%>" title="related"><span>Related</span></a></li>

    <% if @person %>
    <li><a href="<%= url_for :controller => :browse, :action => :browse_upload_tab, :id => @model.id, :tab => 'true' -%>" title="upload"><span>Upload</span></a></li>

    <% if @model.people.include?(@person) %>
    <li><a href="<%= url_for :controller => :browse, :action => :browse_permissions_tab, :id => @model.id, :tab => 'true' -%>" title="permissions"><span>Permissions</span></a></li>
    <% end %>
    <% end %>
  </ul>
</div>
