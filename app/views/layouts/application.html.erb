<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <title>NetLogo Modeling Commons -- <%= @title %></title>

    <%= stylesheet_link_tag 'nlcommons' %>
    <%= stylesheet_link_tag 'browse' %>
    <%= stylesheet_link_tag 'jquery.autocomplete' %>
    <%= stylesheet_link_tag 'themes/nlcommons/ui.all.css' %>

    <%= javascript_include_tag :defaults %>
    <%= javascript_include_tag 'jquery-ui' %>
    <%= javascript_include_tag 'jquery.dataTables' %>
    <%= javascript_include_tag 'jquery.livequery' %>
    <%= javascript_include_tag 'jquery.autocomplete' %>
    <%= javascript_include_tag 'nlcommons' %>
  </head>

  <body>
    <div id="main-menu-div">
      <ul id="main-menu">
        <li class="menu-option"><%= link_to_unless_current "Home", :controller => :account, :action => :mypage %></li>
        <% if @person %>
        <li class="menu-option"><%= link_to "Models", :controller => :browse, :action => :list_models %></li>
        <li class="menu-option"><%= link_to "Groups", :controller => :account, :action => :groups %></li>
        <li class="menu-option"><%= link_to "Tags", :controller => :account, :action => :tags, :id => @person.id  %></li>
        <% end %>
        <li class="menu-option"><%= link_to_unless_current "About", :controller => :browse, :action => :about %></li>
        <li class="menu-option"><%= link_to "Help", :controller => :help, :action => :index  %></li>
        <li id="header_search_form_box"><% form_for(:search_term, :url => { :controller => :browse, :action => :search_action }, :html => { :id => "navbar-search-form"}) do |form| -%> <%= form.text_field :search_term, :value => 'Search', :size => 10 -%><% end -%></li>

      </ul>
    </div>

    <% if @person %>
    <div id="menubar-avatar">
      <%= person_image(@person) %>
    </div>
    <% end %>

    <div id="logged-in-as">
      <% if @person %>
      Logged in as <%= link_to @person.fullname, :controller => :account, :action => :mypage -%><br />
      <%= link_to_unless_current "Edit details", :controller => :account, :action => :edit, :id => @person.id %> &bull;
      <%= link_to_unless_current "Logout", :controller => :account, :action => :logout %>

      <% if @person.administrator %>
      &bull; <%= link_to_unless_current "Admin", :controller => :admin, :action => :index %>
      <% end %>
      <% else %>
      <% if params[:action] != 'login' %>
      <p><%= link_to "Log into the Modeling Commons", :controller => :account, :action => :login -%></p>
      <% end %>
      <% end %>
    </div>

    <% if flash[:notice] -%>
    <div id="flash-notice"><%= flash[:notice] -%></div>
    <script type="text/javascript">
      $(document).ready(function() {
      $('#flash-notice').fadeOut(5000);
      });
    </script>
    <% end -%>

    <h1 id="main-title">
      <% if @headline_avatar -%>
          <%= image_tag @headline_avatar -%>
      <% end -%>

      <% if @headline.blank? -%>
          <%= @title -%>
      <% else -%>
          <%= @headline -%>
      <% end -%>
    </h1>
    <%= yield :layout %>

    <script type="text/javascript">
      var gaJsHost = (("https:" == document.location.protocol) ?
      "https://ssl." : "http://www.");
      document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
      try {
      var pageTracker = _gat._getTracker("UA-8632808-1");
      pageTracker._trackPageview();
      } catch(err) {}
    </script>
  </body>

</html>
